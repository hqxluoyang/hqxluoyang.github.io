webpackJsonp([78],{Qp61:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("mtWM"),a("cQKb");var n={components:{},data:function(){return{data:[],filterText:"",timer:null,treeProps:{label:"bindid",children:"children"},jsonData:[],arry:[]}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){var e=this;window.addEventListener("message",function(t){var a=t.data;e.data.push(e.setTreeData(a.data.enterprise));var n=e.getData(e.data);e.arry=e.setData(n).filter(function(e){return!["人物角色","方向箭头"].includes(e.name)}),console.log("获取:",e.data)})},methods:{setTreeData:function(e){var t={};for(var a in e)e.hasOwnProperty("layer")&&(t[a]=e[a]),e.layer.hasOwnProperty("room")&&(t.children=[],t.children.push(e.layer.room)),e.layer.room.hasOwnProperty("device")&&(t.children[0].children=t.children[0].device);return console.log(t),t},filterNode:function(e,t,a){try{if(!e)return!0;var n=-1!==t.name.indexOf(e),r=a.parent&&a.parent.data&&a.parent.data.name&&-1!==a.parent.data.name.indexOf(e),i=a.parent&&a.parent.parent&&a.parent.parent.data&&a.parent.parent.data.name&&-1!==a.parent.parent.data.name.indexOf(e),s=!1,l=!1,o=!1;return 1===a.level?s=n:2===a.level?l=n||r:3===a.level&&(o=n||r||i),s||l||o}catch(e){}},getData:function(e){try{for(var t=0;t<e.length;t++)if(0!==e[t].children.length){for(var a=e[t].children,n=0;n<a.length;n++)""!==a[n].name&&this.jsonData.push(a[n].name);this.getData(a)}}catch(e){}return this.jsonData},setData:function(e){var t=[];e.sort();for(var a=0;a<e.length;){for(var n=0,r=a;r<e.length;r++)e[a]==e[r]&&n++;t.push([e[a],n]),a+=n}var i=[];for(a=0;a<t.length;a++)i.push({name:t[a][0],value:t[a][1]});return i},getChooseNode:function(e){window.top.postMessage({type:"3dthreebind",data:e},"*")}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-tree animated zoomIn"},[a("div",{staticClass:"header-bar-1"},[e._v("\n        场景树\n    ")]),e._v(" "),a("div",{staticClass:"con"},[a("ul",[e._m(0),e._v(" "),e._l(e.arry,function(t){return a("li",{key:t.name},[a("span",{staticStyle:{"font-size":"10px"}},[e._v(e._s(t.name))]),e._v(" "),a("span",{staticClass:"valueItem",staticStyle:{"font-size":"10px"}},[e._v(e._s(t.value))])])})],2),e._v(" "),a("div",{staticStyle:{"margin-top":"20px",padding:"0 15px"}},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1)]),e._v(" "),a("div",{staticClass:"mytree"},[a("el-tree",{ref:"tree",staticClass:"tree fl",attrs:{data:e.data,props:e.treeProps,"node-key":"id","default-expand-all":!0,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"highlight-current":"",indent:0},on:{"node-click":e.getChooseNode},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticStyle:{color:"white"}},[e._v(e._s(n.label))]),e._v(" "),a("span",{staticStyle:{"font-size":"15px",color:"white"}},[e._v(e._s(r.name))])])}}])})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{"font-size":"10px"}},[this._v("消防设施")]),this._v(" "),t("span",{staticClass:"valueItem",staticStyle:{"font-size":"10px"}},[this._v("0")])])}]};var i=a("VU/8")(n,r,!1,function(e){a("pKHk")},"data-v-a75889a8",null);t.default=i.exports},pKHk:function(e,t){}});